!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="./dist/",n(n.s=1)}([function(e,t,n){},function(e,t,n){"use strict";n.r(t);n(0);const r=0,o=1,l=2,i=3,s=4,c=5,u="абвгдежзиклмнопрст",d={0:{len:3,count:1},1:{len:2,count:2},2:{len:1,count:3}};function f(e){return e===r||e>=s?0:1}function a(e,t){return m(e,t,()=>{})}function h(e,t,n){if(!e[n])return s;const r=a(e,n),c=a(t,n);if(c===r)return function(e,t,n){if(e.length!==t.length)throw"Illegal state";for(let r=0;r<e.length;++r)if(r!==n&&e[r]!==f(t[r]))return!1;return!0}(e,t,n)?i:l;if(c<r)return o;throw"Illegal state"}function p(e,t,n,o){let l=t+n,i=0;for(;l<e.length&&l>=0;){if(!f(e[l])){e[l]===r&&o(l);break}l+=n,++i}return i}function m(e,t,n){let r=1;return r+=p(e,t,1,n),r+=p(e,t,-1,n),r}function g(e){return Math.floor((e.offsetX+1)/20)}function y(e,t){t(g(e))}function v(e){return document.querySelector(e)}function L(e){const t=v("#field-template").content.cloneNode(!0),n=t.firstElementChild,r=n.querySelector(".frame-text");for(const e of u){const t=document.createElement("span");t.textContent=e,r.appendChild(t)}return e.appendChild(t).firstElementChild,n}function E(e,t,n,c,u){let d=!1;const f=function(e){const t=L(e);return t.classList.add("adjust-second"),t.querySelector(".river")}(e.querySelector(".grid")),a=e.querySelector(".river"),p={realField:n,guessedField:new Array(n.length).fill(r),htmlRiver:a,onOpponentMiss:()=>{console.log("player hit")},onOpponentHit:u,isEnemy:!1},g={realField:c,guessedField:new Array(n.length).fill(r),htmlRiver:f,onOpponentMiss:u,onOpponentHit:()=>{console.log("player hit")},isEnemy:!0};let E=null;function b(t){const n=d?p:g,r=function(e,t,n,r,o){let l=n[e];r[e]=l;const i=h(n,r,e);let s;r[e]=i,s=v(l?"#ship-template":"#dot-template2");const c=s.content.cloneNode(!0),u=c.firstElementChild;return l?t?u.classList.add("diagonal-line-enemy"):u.classList.add("diagonal-line"):t&&u.classList.add("enemy"),o.appendChild(c),u.style.left=20*e+"px",u.style.width="20px",{html:u,res:l,verdict:i}}(t,d,n.realField,n.guessedField,n.htmlRiver),c=((u=r.verdict)===o?"Ранил":u===l?"Убил":u===s?"Мимо":u===i?"Победа":void 0)+"!";var u;!function(t,n,r){let o=0;const l=e.querySelector(".message");r?l.classList.add("enemy"):l.classList.remove("enemy"),E&&(l.innerHTML="",clearInterval(E)),E=setInterval((function(){l.innerHTML+=t.charAt(o),o++,o>t.length&&(clearInterval(E),E=setTimeout(()=>{l.innerHTML=""},2e3))}),n)}(c,70,d),console.log(c),r.verdict===s?(d=!d,n.onOpponentMiss(r.verdict)):r.verdict===i?d?setTimeout(()=>{alert("Ты проиграл")},700):setTimeout(()=>{alert("Победа")},700):(n.onOpponentHit(r.verdict),r.verdict===l&&m(n.guessedField,t,e=>{!function(e,t,n){const r=v("#dot-template").content.cloneNode(!0),o=r.firstElementChild;n&&o.classList.add("enemy"),t.appendChild(r),o.style.left=20*e+"px",o.style.width="20px"}(e,n.htmlRiver,d)}))}return a.addEventListener("click",(function(e){d&&y(e,b)})),f.addEventListener("click",(function(e){d||y(e,b)})),{fireEnemy:function(e){d&&b(e)}}}function b(e){return function(e,t){let n=e+Math.random()*(t-e);return Math.floor(n)}(0,e)}function w(e){let t=function(e){let t=0;for(let n=0;n<e.length;n++)e[n]===r&&++t;return b(t)}(e),n=0;for(console.table("rnd index "+t);n<e.length&&(e[n]===r&&--t,!(t<0));n++);return(n>=e.length||n<0)&&console.table("Error out",n,e),n}function x(e){const t=[[0,1,0,0,0,1,0,1,1,0,1,0,1,1,0,1,1,1],[0,1,0,0,1,0,1,0,1,1,0,1,1,0,1,1,1,0],[0,0,0,1,0,1,0,1,0,1,1,1,0,1,1,0,1,1],[1,0,1,0,0,0,1,0,0,1,1,0,1,1,1,0,1,1]];return e<0&&(e=b(t.length)),t[e]}function O(e,t){const n=x(t),i=new Array(e).fill(r);let u=-1,d=0;function f(e,t){if(u<0)return w(e);if(e[u]=t,t===o){d=function(){let e=b(2);return 0===e?-1:e}();let n=-1;return p(e,u,d,e=>{n=e}),n>=0?n:(d*=-1,p(e,u,d,e=>{n=e}),n>=0?n:(console.table("Err1",t,d,u,e),w(e)))}if(t===l)return m(e,u,t=>{e[t]=c}),d=0,w(e);if(t===s){if(0!==d){d*=-1;let n=-1;return p(e,u,d,e=>{n=e}),n>=0?n:(console.table("Err",t,d,u,e),w(e))}return w(e)}return 1}return{getFieldEnemy:function(){return n},guess:function(e){return console.log(e),u=f(i,e),u}}}function S(e){console.log(e);const t=O(e.length,-1),n=E(document,window,e,t.getFieldEnemy(),(function(e){const r=t.guess(e);console.log(r),setTimeout(()=>{n.fireEnemy(r)},700)}))}!function(e,t,n){let r=null,o=0;const l=new Array(u.length).fill(0),i=[],s=e.querySelector(".grid"),c=L(s);c.classList.add("adjust-first");const f=function(e,t){const n=e.createElement("div");return n.classList.add("shipyard"),t.appendChild(n),n}(e,s);function a(t){i.push(function(t){const n=e.createElement("div");return n.classList.add("ship"),n.style.width=20*t+"px",f.appendChild(n),{length:t,html:n}}(t)),++o}for(let[e,t]of Object.entries(d))for(let e=0;e<t.count;e++)a(t.len);function h(e,t){r={s:e,n:t};for(const e of i)e.html.classList.remove("choosen");e.html.classList.add("choosen")}for(const e of i)e.html.addEventListener("click",t=>{const n=g(t);h(e,n)});const p=e.querySelector(".river");function m(t){const i=t-r.n;if(!function(e,t,n){if(!function(e,t,n){if(t<0)return!1;const r=t-1;if(r>=0&&e[r]>0)return!1;for(let r=0;r<n;r++){const n=t+r;if(n>e.length-1)return!1;if(e[n]>0)return!1}const o=t+n;return!(o<e.length&&e[o]>0)}(e,t,n))return!1;for(let r=0;r<n;r++)e[t+r]=1;return--o,!0}(l,i,r.s.length))return;const s=e.createElement("div");s.classList.add("ship_river"),s.classList.add("diagonal-line"),s.style.width=r.s.html.style.width,s.style.left=20*i+"px",p.appendChild(s),r.s.html.classList.add("disabled"),r=null,0===o&&(c.classList.remove("adjust-first"),c.classList.add("adjust-third"),p.removeEventListener("click",v),n(l))}function v(e){null!=r&&y(e,m)}p.addEventListener("click",v)}(document,window,S),console.log("Service workers!"),"serviceWorker"in navigator&&navigator.serviceWorker.register("./sw.js",{scope:"./"})}]);