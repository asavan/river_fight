!function(e){var t={};function n(r){if(t[r])return t[r].exports;var l=t[r]={i:r,l:!1,exports:{}};return e[r].call(l.exports,l,l.exports,n),l.l=!0,l.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var l in e)n.d(r,l,function(t){return e[t]}.bind(null,l));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){},function(e,t,n){"use strict";n.r(t);n(0);function r(e){return Math.floor((e.offsetX+1)/20)}function l(e,t){t(r(e))}function o(e){return document.querySelector(e)}function i(e){const t=o("#field-template").content.cloneNode(!0),n=t.firstElementChild;return e.appendChild(t).firstElementChild,n}const s=0,c=1,u=2,d=3,f=4,a=5,h={3:1,2:2,1:3};function p(e){return e===s||e>=f?0:1}function m(e,t){return v(e,t,()=>{})}function g(e,t,n){if(!e[n])return f;const r=m(e,n),l=m(t,n);if(l===r)return function(e,t,n){if(e.length!==t.length)throw"Illegal state";for(let r=0;r<e.length;++r)if(r!==n&&e[r]!==p(t[r]))return!1;return!0}(e,t,n)?d:u;if(l<r)return c;throw"Illegal state"}function y(e,t,n,r){let l=t+n,o=0;for(;l<e.length&&l>=0;){if(!p(e[l])){e[l]===s&&r(l);break}l+=n,++o}return o}function v(e,t,n){let r=1;return r+=y(e,t,1,n),r+=y(e,t,-1,n),r}function L(e,t,n,r,a){let h=!1;const p=function(e){const t=i(e);return t.classList.add("adjust-second"),t.querySelector(".river")}(e.querySelector(".grid")),m=e.querySelector(".river"),y={realField:n,guessedField:new Array(n.length).fill(s),htmlRiver:m,onOpponentMiss:()=>{console.log("player hit")},onOpponentHit:a,isEnemy:!1},L={realField:r,guessedField:new Array(n.length).fill(s),htmlRiver:p,onOpponentMiss:a,onOpponentHit:()=>{console.log("player hit")},isEnemy:!0};let E=null;function b(t){const n=h?y:L,r=function(e,t,n,r,l){let i=n[e];r[e]=i;const s=g(n,r,e);let c;r[e]=s,c=o(i?"#ship-template":"#dot-template2");const u=c.content.cloneNode(!0),d=u.firstElementChild;return i?t?d.classList.add("diagonal-line-enemy"):d.classList.add("diagonal-line"):t&&d.classList.add("enemy"),l.appendChild(u),d.style.left=20*e+"px",d.style.width="20px",{html:d,res:i,verdict:s}}(t,h,n.realField,n.guessedField,n.htmlRiver),l=((i=r.verdict)===c?"Ранил":i===u?"Убил":i===f?"Мимо":i===d?"Победа":void 0)+"!";var i;!function(t,n,r){let l=0;const o=e.querySelector(".message");r?o.classList.add("enemy"):o.classList.remove("enemy"),E&&(o.innerHTML="",clearInterval(E)),E=setInterval((function(){o.innerHTML+=t.charAt(l),l++,l>t.length&&(clearInterval(E),E=setTimeout(()=>{o.innerHTML=""},2e3))}),n)}(l,70,h),console.log(l),r.verdict===f?(h=!h,n.onOpponentMiss(r.verdict)):r.verdict===d?h?setTimeout(()=>{alert("Ты проиграл")},700):setTimeout(()=>{alert("Победа")},700):(n.onOpponentHit(r.verdict),r.verdict===u&&v(n.guessedField,t,e=>{!function(e,t,n){const r=o("#dot-template").content.cloneNode(!0),l=r.firstElementChild;n&&l.classList.add("enemy"),t.appendChild(r),l.style.left=20*e+"px",l.style.width="20px"}(e,n.htmlRiver,h)}))}return m.addEventListener("click",(function(e){h&&l(e,b)})),p.addEventListener("click",(function(e){h||l(e,b)})),{fireEnemy:function(e){h&&b(e)}}}function E(e){return function(e,t){let n=e+Math.random()*(t-e);return Math.floor(n)}(0,e)}function b(e){let t=function(e){let t=0;for(let n=0;n<e.length;n++)e[n]===s&&++t;return E(t)}(e),n=0;for(console.table("rnd index "+t);n<e.length&&(e[n]===s&&--t,!(t<0));n++);return(n>=e.length||n<0)&&console.table("Error out",n,e),n}function w(e){const t=[[0,1,0,0,0,1,0,1,1,0,1,0,1,1,0,1,1,1],[0,0,0,1,0,1,0,1,0,1,1,1,0,1,1,0,1,1]];return e<0&&(e=E(t.length)),t[e]}function O(e,t){const n=w(t),r=new Array(e).fill(s);let l=-1,o=0;function i(e,t){if(l<0)return b(e);if(e[l]=t,t===c){o=function(){let e=E(2);return 0===e?-1:e}();let n=-1;return y(e,l,o,e=>{n=e}),n>=0?n:(o*=-1,y(e,l,o,e=>{n=e}),n>=0?n:(console.table("Err1",t,o,l,e),b(e)))}if(t===u)return v(e,l,t=>{e[t]=a}),o=0,b(e);if(t===f){if(0!==o){o*=-1;let n=-1;return y(e,l,o,e=>{n=e}),n>=0?n:(console.table("Err",t,o,l,e),b(e))}return b(e)}return 1}return{getFieldEnemy:function(){return n},guess:function(e){return console.log(e),l=i(r,e),l}}}function M(e){console.log(e);const t=O(e.length,-1),n=L(document,window,e,t.getFieldEnemy(),(function(e){const r=t.guess(e);console.log(r),setTimeout(()=>{n.fireEnemy(r)},500)}))}!function(e,t,n){let o=null,s=0;const c=new Array("абвгдежзиклмнопрст".length).fill(0),u=[],d=e.querySelector(".grid"),f=i(d);f.classList.add("adjust-first");const a=function(e,t){const n=e.createElement("div");return n.classList.add("shipyard"),t.appendChild(n),n}(e,d);function p(t){u.push(function(t){const n=e.createElement("div");return n.classList.add("ship"),n.style.width=20*t+"px",a.appendChild(n),{length:t,html:n}}(t)),++s}for(let[e,t]of Object.entries(h))for(let n=0;n<t;n++)console.log("add ship",""+e);p(3);for(let e=0;e<2;e++)p(2);for(let e=0;e<3;e++)p(1);function m(e,t){o={s:e,n:t};for(const e of u)e.html.classList.remove("choosen");e.html.classList.add("choosen")}for(const e of u)e.html.addEventListener("click",t=>{const n=r(t);m(e,n)});const g=e.querySelector(".river");function y(t){const r=t-o.n;if(!function(e,t,n){if(!function(e,t,n){if(t<0)return!1;const r=t-1;if(r>=0&&e[r]>0)return!1;for(let r=0;r<n;r++){const n=t+r;if(n>e.length-1)return!1;if(e[n]>0)return!1}const l=t+n;return!(l<e.length&&e[l]>0)}(e,t,n))return!1;for(let r=0;r<n;r++)e[t+r]=1;return--s,!0}(c,r,o.s.length))return;const l=e.createElement("div");l.classList.add("ship_river"),l.classList.add("diagonal-line"),l.style.width=o.s.html.style.width,l.style.left=20*r+"px",g.appendChild(l),o.s.html.classList.add("disabled"),o=null,0===s&&(f.classList.remove("adjust-first"),f.classList.add("adjust-third"),g.removeEventListener("click",v),n(c))}function v(e){null!=o&&l(e,y)}g.addEventListener("click",v)}(document,window,M)}]);